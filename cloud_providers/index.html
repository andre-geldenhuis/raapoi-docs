<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://vuw-research-computing.github.io/raapoi-docs/cloud_providers/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Connecting to Cloud Providers - Rāpoi Cluster Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Connecting to Cloud Providers";
        var mkdocs_page_input_path = "cloud_providers.md";
        var mkdocs_page_url = "/raapoi-docs/cloud_providers/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Rāpoi Cluster Documentation
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Documentation</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../accessing_the_cluster/">Accessing the Cluster</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basic_commands/">Basic Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../storage/">Storage and Quotas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../partitions/">Using Partitions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../environment/">Preparing your Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../running_jobs/">Running Jobs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parallel_processing/">Parallel Processing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../managing_jobs/">Managing Jobs</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Connecting to Cloud Providers</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#aarnet-cloudstor">AARNET Cloudstor</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#amazon-aws">Amazon AWS</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#google-cloud-gcloud-connections">Google Cloud (gcloud) Connections</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dropbox-cloud-storage">DropBox Cloud Storage</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../containers/">Using Containers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../notebooks/">Using Jupyter Notebooks</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../training/">Training</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../usersub/">User Submitted Docs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../support/">Support</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Rāpoi Cluster Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Documentation &raquo;</li><li>Connecting to Cloud Providers</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="connecting-to-cloud-providers">Connecting to Cloud Providers<a class="headerlink" href="#connecting-to-cloud-providers" title="Permanent link">&para;</a></h1>
<h2 id="aarnet-cloudstor">AARNET Cloudstor<a class="headerlink" href="#aarnet-cloudstor" title="Permanent link">&para;</a></h2>
<p>All VUW researchers have access to the AARNET (Australia’s Academic and Research
Network) Cloudstor service which provides <strong>1 TB</strong> of space to each researcher.  To
use this service first login and download an appropriate client to your laptop
or desktop (or smarthone if you wish):</p>
<p><a href="https://www.aarnet.edu.au/login">Cloudstor Login</a></p>
<p>NOTE: Within the Cloudstor web login settings you will need to create a Cloudstor Password, this is the password you will use to login on Rāpoi, it does not use your VUW credentials for the command line login.</p>
<p>We suggest setting up an App Password for Raapoi-rcopy  rather than a global sync password. This way if your password is compromised you can easily just remove that app password.  Setup an App Password by clicky on the settings gear on the top right and finding the <a href="https://cloudstor.aarnet.edu.au/plus/settings/personal?sectionid=security">App Password link</a>.</p>
<p>Once you have setup your cloudstor (aka ownCloud) credentials you can use them
to sync data to and from Rāpoi.  For example, if I wanted to sync my project
space to Cloudstor I would do the following from Rāpoi login node:</p>
<pre class="codehilite"><code class="language-bash"># Use Tmux to keep your session alive if you disconnect. You can reconnect to your Tmux session if you reconnect. See Tmux docs.  
tmux  

# Use our new module system
module use /home/software/tools/eb_modulefiles/all/Core
module load rclone/1.54.1

#check if cloudstor remote is already configured
rclone listremotes
</code></pre>

<p>The above sequence starts a tmux session to allow the transfer to continue even if I disconnect from the cluster
(type <code>tmux attach</code> to reconnect) and then loads the rcopy module - which requires the use of our new module system.</p>
<p>If you don't already have CloudStor configured as a remote (which you won't if this is your first time using it) <a href="https://support.aarnet.edu.au/hc/en-us/articles/115007168507-Can-I-use-the-command-line-or-WebDav-">follow the instructions on aarnet docs page</a>.</p>
<p>Once we have setup <em>rclone</em> to connect to CloudStor, we copy our data. In this case from<code>&lt;my scratch folder&gt;/test</code> to <code>test</code> on CloudStor</p>
<pre class="codehilite"><code> rclone copy --progress --transfers 8 /nfs/scratch/geldenan/test CloudStor:/test
</code></pre>

<h2 id="amazon-aws">Amazon AWS<a class="headerlink" href="#amazon-aws" title="Permanent link">&para;</a></h2>
<p>A feature-rich CLI is available in Rāpoi.  To use it you need to load the appropriate module and its module dependencies:</p>
<p><code>module load amazon/aws/cli</code></p>
<p>Before you proceed you will need to configure your environment with your Access Key ID and Secret Access Key, both of which will be sent to you once your account is created or linked.  The command to configure your environment is <code>aws configure</code>  You only need to do this once, unless of course you use more than one user/Access Key.  Most users can simply click through the region and profile questions (using the default of "none").  If you do have a specific region this should be relayed along with your access and secret keys.</p>
<p>Once you have the appropriate environment in place and your configuration setup you can use the aws command, plus an appropriate sub-command (s3, emr, rds, dynamodb, etc) and supporting arguments. </p>
<p>More information on the CLI can be found here:
<a href="http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-using.html">http://docs.aws.amazon.com/cli/latest/userguide/cli-chap-using.html</a></p>
<h4 id="transferring-data-tofrom-amazon-aws-s3">Transferring Data to/from Amazon (AWS) S3<a class="headerlink" href="#transferring-data-tofrom-amazon-aws-s3" title="Permanent link">&para;</a></h4>
<p>To transfer data from S3 you first need to setup your AWS connect, instructions for that can be found above.
Once that is done you should be able to use the aws commands to copy data to and from your S3 storage.  </p>
<p>For example if I wanted to copy data from my S3 storage to my project directory I could do the following:</p>
<pre class="codehilite"><code>  tmux
  module load amazon/aws/cli
  cd /nfs/scratch/harrelwe/project
  aws s3 cp s3://mybucket/mydata.dat mydata.dat
</code></pre>

<p>To copy something to storage simply reverse the file paths, eg.</p>
<pre class="codehilite"><code>  aws s3 cp mydata.dat s3://mybucket/mydata.dat 
</code></pre>

<p>The above starts a tmux session to allow the transfer to continue even if I
disconnect from the cluster (type <code>tmux attach</code> to reconnect).  I then load the
modules necessary to use the AWS commands.  I change directory to my project
space and use the aws s3 cp command to copy from S3.  More information on using
aws can be found here:
<a href="http://docs.aws.amazon.com/cli/latest/reference/s3/index.html#cli-aws-s3">http://docs.aws.amazon.com/cli/latest/reference/s3/index.html#cli-aws-s3</a></p>
<h4 id="working-with-aws-data-analysis-tools">Working with AWS Data Analysis Tools<a class="headerlink" href="#working-with-aws-data-analysis-tools" title="Permanent link">&para;</a></h4>
<p>Amazon has a number of data analytics and database services available.  Using the command line utilities available in Rāpoi, researchers can perform work on the eo cluster and transfer data to AWS to perform further analysis with tools such as MapReduce (aka Hadoop), RedShift or Quicksight.</p>
<p>A listing of available services and documentation can be found at the following:
<a href="https://aws.amazon.com/products/analytics/">https://aws.amazon.com/products/analytics/</a></p>
<h2 id="google-cloud-gcloud-connections">Google Cloud (gcloud) Connections<a class="headerlink" href="#google-cloud-gcloud-connections" title="Permanent link">&para;</a></h2>
<p>The Google Cloud SDK is available in Rāpoi.  This includes a command-line interface for connecting to gloud services.  To get started, first load the environment module.  You can find the path with the <code>module spider</code> command.  As of this writing the current version can be loaded thusly:</p>
<p>module load google/cloud/sdk/212.0.0</p>
<p>This will give you access to the <code>gcloud</code> command.  To setup a connection to your gcloud account use the init sub-command, eg.</p>
<p><code>gcloud init --console-only</code></p>
<p>Follow the instructions to authorize your gcloud account.  Once on the Google website, you will be given an authorization code which you will copy/paste back into the Rāpoi terminal window.</p>
<h4 id="transferring-data-tofrom-google-cloud-gcloud">Transferring Data to/from Google Cloud (gcloud)<a class="headerlink" href="#transferring-data-tofrom-google-cloud-gcloud" title="Permanent link">&para;</a></h4>
<p>To transfer data from gcloud storage you first need to setup your gcloud credentials, instructions for that can be found above.  Once that is done you should be able to use the <code>gsutil</code> command to copy data to and from your gcloud storage.  </p>
<p>For example, if I wanted to copy data from gcloud to my project directory I could do the following:</p>
<pre class="codehilite"><code>  tmux
  module load google/cloud/sdk/212.0.0
  cd /nfs/scratch/harrelwe/project
  gsutil cp gs://mybucket/mydata.dat mydata.dat
</code></pre>

<p>To copy something to storage simply reverse the file paths, eg.</p>
<pre class="codehilite"><code>  gsutil cp mydata.dat gs://mybucket/mydata.dat 
</code></pre>

<p>The above starts a tmux session to allow the transfer to continue even if I
disconnect from the cluster (type <code>tmux attach</code> to reconnect).  I then load the
modules necessary to use the gsutil commands.  I change directory to my project
space and use the gsutil cp command to copy from gcloud.  More information on
using gcloud can be found here:
<a href="https://cloud.google.com/sdk/gcloud/">https://cloud.google.com/sdk/gcloud/</a></p>
<h4 id="working-with-gcloud-data-analysis-tools">Working with GCloud Data Analysis Tools<a class="headerlink" href="#working-with-gcloud-data-analysis-tools" title="Permanent link">&para;</a></h4>
<p>Google Cloud has a number of data analytics and database services available.  Using the gcloud command line utilities available on Rāpoi, researchers can perform work on the cluster and transfer data to gcloud to perform further analysis with tools such as Dataproc (Hadoop/Spark), BigQuery or Datalab (Visualization)</p>
<p>A listing of available services and documentation can be found at the following:
<a href="https://cloud.google.com/products/">https://cloud.google.com/products/</a></p>
<h2 id="dropbox-cloud-storage">DropBox Cloud Storage<a class="headerlink" href="#dropbox-cloud-storage" title="Permanent link">&para;</a></h2>
<p><strong>NOTE:</strong> Dropbox has upload/download limitations and we have found that once your file gets above 50GB in size the transfer will have a better chance of timing out and failing.</p>
<p>Configuring your Dropbox account on Rāpoi</p>
<p><strong>Step A:</strong>  On your local laptop or desktop start your browser and login to your Dropbox account</p>
<p><strong>Step B:</strong> On Rāpoi type the following:</p>
<p><code>module load dropbox</code></p>
<p><strong>Step C:</strong> Setup account credentials (You should only need to do this once):</p>
<p>Run the following command from Rāpoi</p>
<p><code>dbxcli account</code></p>
<p>You will now see something like the following:</p>
<ol>
<li>Go to https://www.dropbox.com/1/oauth2/authorize?client_id=X12345678&amp;response_type=code&amp;state=state</li>
<li>Click "Allow" (you might have to log in first).</li>
<li>Copy the authorization code.
  Enter the authorization code here:</li>
</ol>
<p><strong>Step D:</strong></p>
<p>Copy the URL link listed in Step C1 and paste it into the web browser that you started in Step A</p>
<p>This will provide you with a long access code (aka hash).  Now copy that access code and paste it into your Rāpoi terminal after Step C3 where it is asking for Enter the authorization code here </p>
<p>Now hit enter or return.  You should see that you are now logged in with your Dropbox credentials</p>
<h4 id="basic-dropbox-commands">Basic Dropbox commands<a class="headerlink" href="#basic-dropbox-commands" title="Permanent link">&para;</a></h4>
<p>Remember to load the dropbox environment module if you have not already (see <code>module spider</code> for the path)</p>
<p>Now type <code>dbx</code> or <code>dbxcli</code> at a prompt.  You will see a number of sub-commands, for instance ls, which will list the contents of your Dropbox, eg</p>
<p><code>dbxcli ls</code></p>
<h4 id="downloading-from-dropbox">Downloading from Dropbox<a class="headerlink" href="#downloading-from-dropbox" title="Permanent link">&para;</a></h4>
<p>Downloading uses the subcommand called: get.   The basic format for get is:</p>
<p><code>dbxcli get fileOnDropbox fileOnRaapoi</code></p>
<p>For instance, if I have a datafile called 2018-financials.csv on Dropbox that I want to copy to my project folder I would type:</p>
<p><code>dbxcli get 2018-financials.csv /nfs/scratch/harrelwe/projects/finance_proj/2018-financials.csv</code></p>
<h4 id="uploading-to-dropbox">Uploading to Dropbox<a class="headerlink" href="#uploading-to-dropbox" title="Permanent link">&para;</a></h4>
<p>Uploading is similar to downloading except now we use the subcommand: put.  The basic format for put is:</p>
<p><code>dbxcli put fileOnRaapoi fileOnDropbox</code></p>
<p>For example I want to upload a PDF I generated from one of my jobs called final-report.pdf I would type:</p>
<p><code>dbxcli put final-report.pdf final-report.pdf</code></p>
<p>This will upload the PDF and name it the same thing, if I wanted to change the name on Dropbox I could:</p>
<p><code>dbxcli put final-report.pdf analytics-class-final-report.pdf</code></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../managing_jobs/" class="btn btn-neutral float-left" title="Managing Jobs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../containers/" class="btn btn-neutral float-right" title="Using Containers">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../managing_jobs/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../containers/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
