<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><link rel="canonical" href="https://vuw-research-computing.github.io/raapoi-docs/notebooks/" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Using Jupyter Notebooks - Rāpoi Cluster Documentation</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Using Jupyter Notebooks";
        var mkdocs_page_input_path = "notebooks.md";
        var mkdocs_page_url = "/raapoi-docs/notebooks/";
      </script>
    
    <script src="../js/jquery-3.6.0.min.js" defer></script>
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
      <script>hljs.initHighlightingOnLoad();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Rāpoi Cluster Documentation
        </a>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Overview</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Documentation</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../accessing_the_cluster/">Accessing the Cluster</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../basic_commands/">Basic Commands</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../storage/">Storage and Quotas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../partitions/">Using Partitions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../environment/">Preparing your Environment</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../running_jobs/">Running Jobs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../parallel_processing/">Parallel Processing</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../managing_jobs/">Managing Jobs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../cloud_providers/">Connecting to Cloud Providers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../containers/">Using Containers</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Using Jupyter Notebooks</a>
    <ul class="current">
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../examples/">Examples</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../training/">Training</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../usersub/">User Submitted Docs</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../support/">Support</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Rāpoi Cluster Documentation</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" alt="Docs"></a> &raquo;</li>
          <li>Documentation &raquo;</li><li>Using Jupyter Notebooks</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>

          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h2 id="starting-and-working-with-a-jupyter-notebook">Starting and Working with a Jupyter Notebook<a class="headerlink" href="#starting-and-working-with-a-jupyter-notebook" title="Permanent link">&para;</a></h2>
<p><strong>Step 1:</strong> The best way to start jupyter is with a batch submit script.  We have created an example script.  You can copy this script from one available on the cluster, just type the following:</p>
<pre class="codehilite"><code>cp /home/software/vuwrc/examples/jupyter/notebook.sh notebook.sh
</code></pre>

<p>If you are using Anaconda and have installed it in the default location you need to use the following submit file instead:</p>
<pre class="codehilite"><code>cp /home/software/vuwrc/examples/jupyter/notebook-anaconda.sh notebook-anaconda.sh
</code></pre>

<p><strong>NOTE</strong>: We also have sbatch scripts for R (IRKernel)) notebooks.  These are called <em>R-notebook.sh</em> and <em>R-notebook-anaconda.sh</em></p>
<p>This script is ready to run as is, but we recommend editing it to satisfy your own CPU, memory and time requirements.  Once you have edited the file you can run it thusly:</p>
<pre class="codehilite"><code>sbatch notebook.sh
</code></pre>

<p>or if using Anaconda:</p>
<pre class="codehilite"><code>sbatch notebook-anaconda.sh
</code></pre>

<p><strong>NOTE:</strong> If you copied the R notebook script, replace notebook.sh with R-notebook.sh</p>
<p>This will submit the file to run a job.  It may take some time for the job to
run, depending on how busy the cluster is at the time.  Once the job begins to
run you will see some information in the file called notebook-JOBID.out (JOBID
will be the actual jobid of this job, eg notebook-478903.out.  If you view this
file (users can type <code>cat notebook-JOBID.out</code> to view the file onscreen).  You will see a line such as:</p>
<p><em>The Jupyter Notebook is running at: http://130.195.19.20:47033/?token=SOME-RANDOM-HASH</em></p>
<p>The 2 important pieces of information here are the IP address, in this case <em>130.195.19.20</em> and the port number, <em>47033</em>.   These numbers should be different for you since the port number is random, although the IP Address may be the same since we have a limited number of compute nodes. Also notice after the ?token= you will see a random hash.  This hash is a security feature and allows you to connect to the notebook.  You will need to use these to view the notebook from your local machine.  </p>
<p><strong>Step 2:</strong> To start working with the notebook you will need to tunnel a ssh
session.  In your SSH tunnel you will use the cluster login node (raapoi.vuw.ac.nz)
to connect to the compute node (in the example above the compute node is at
address 130.195.19.20) and transfer all the traffic back and forth between your computer and the compute node).  </p>
<p><strong>Step 2a from a Mac:</strong></p>
<p>Open a new session window from Terminal.app or other terminal utility such as Xquartz and type the following:</p>
<pre class="codehilite"><code>ssh -L &lt;PORT_NUMBER&gt;:&lt;IP_ADDRESS&gt;:&lt;PORT_NUMBER&gt; username@raapoi.vuw.ac.nz
</code></pre>

<p>For example:</p>
<pre class="codehilite"><code>ssh -L 47033:130.195.19.20:47033 harrelwe@raapoi.vuw.ac.nz
</code></pre>

<p>Once you are at a prompt you can go to Step 3</p>
<p><strong>Step 2b: from Windows</strong></p>
<p>We recommend tunnelling using Git Bash, which is part of the <a href="https://gitforwindows.org/">Git for Windows project</a> or <a href="https://mobaxterm.mobatek.net/">MobaXTerm</a>.  There are 2 methods for tunneling in Moba, one is command line, the other is GUI-based.</p>
<p><em>Method 1 (Git Bash or MobaXterm):</em>
Command-line, start a local Git Bash or MobaXterm terminal (or try the GUI method, below)</p>
<p>From the command prompt type:</p>
<pre class="codehilite"><code>ssh -L &lt;PORT_NUMBER&gt;:&lt;IP_ADDRESS&gt;:&lt;PORT_NUMBER&gt; username@raapoi.vuw.ac.nz
</code></pre>

<p>For example:</p>
<pre class="codehilite"><code>ssh -L 47033:130.195.19.20:47033 harrelwe@raapoi.vuw.ac.nz
</code></pre>

<p>Once you are at a prompt you can go to Step 3</p>
<p><em>Method 2 (MobaXterm):</em>
GUI-based, go to the Tunneling menu:</p>
<p>Now click on <em>New SSH Tunnel</em></p>
<p>When you complete the creation of your tunnel click <strong>Start all tunnels</strong>.  Enter your password and reply "yes" to any questions asked about accepting hostkeys or opening firewalls.  You can safely exit the tunnel building menu.</p>
<p><strong>Step 3</strong></p>
<p>Now open your favorite web browser and then use the URL from your job output file and paste it in your browsers location bar, for example my full URL was:</p>
<p><strong>http://130.195.19.20:47033/?token=badef11b1371945b314e2e89b9a182f68e39dc40783ed68e</strong></p>
<p><strong>Step 4</strong></p>
<p>One last thing you need to do is to replace the IP address with the word <em>localhost</em>.  This will allow your browser to follow the tunnel you just opened and connect to the notebook running on an engaging compute node, in my case my address line will now look like this:</p>
<p><strong>http://localhost:47033/?token=badef11b1371945b314e2e89b9a182f68e39dc40783ed68e</strong></p>
<p>Now you can hit return and you should see your notebook running on an Engaging compute node.</p>
<p><strong>NOTE</strong>: when you are done with your notebook, please remember to cancel your
job to free up the resources for others, hint: <em>scancel</em></p>
<p>If you want more information on working with Jupyter, there is good
documentation, here: <a href="http://jupyter-notebook.readthedocs.io/en/latest/">Jupyter Notebooks</a></p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../containers/" class="btn btn-neutral float-left" title="Using Containers"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../examples/" class="btn btn-neutral float-right" title="Examples">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../containers/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../examples/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script>var base_url = '..';</script>
    <script src="../js/theme_extra.js" defer></script>
    <script src="../js/theme.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(true);
        };
    </script>

</body>
</html>
